<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
        html,
        body {
        font-family: Arial;
        font-size: 16px;
        color: #fff;
        height: 100%;
        }

        body {
        background: #10131c;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        -webkit-font-smoothing: antialiased;
        -webkit-tap-highlight-color: transparent;
        }

        button {
        font-family: Arial;
        font-size: 16px;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        background-color: #4CAF50;
        color: #fff;
        cursor: pointer;
        margin-right: 10px;
        margin-top: 20px;
        width: 250px;
        }

        button:disabled {
        background-color: #ccc;
        cursor: default;
        }

        button:disabled:hover {
            background-color: #ccc;
            cursor: default;
        }

        h1 {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 0;
            font-size: 3.5rem;
            margin-bottom: 200px;
        }
        

        button:hover {
            background-color: #409e3a;
        }

        #downloadLink {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        margin-top: 20px;
        }

        #downloadLink {
        font-family: Arial;
        font-size: 16px;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        background-color: #008CBA;
        color: #fff;
        text-decoration: none;
        margin-right: 10px;
        text-align: center;
        width: 210px;
        }

        #downloadLink:hover {
        background-color: #006F8B;
        }

        #refreshButton {
        font-family: Arial;
        font-size: 16px;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        background-color: #4CAF50;
        color: #fff;
        cursor: pointer;
        margin-top: 20px;
        }

        #refreshButton:hover {
            background-color: #409e3a;
        }

        #refreshButton:disabled {
        background-color: #ccc;
        cursor: default;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
        }
        
        .modal-content {
            background-color: #dbdbdb;
            color: black;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 60%;
            max-width: 800px;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        
        #aboutLink {
        margin-top: 400px;
        }
    </style>
    <link rel="shortcut icon" type="image/x-icon" href="assets/favicon.ico">
    <meta charset="utf-8">
    <title>JK ScreenRecorder</title>
  </head>
  <body>
    <h1>JK Screen-Recorder</h1>
    <button id="startButton">Start Recording</button>
    <button id="stopButton" disabled>Stop Recording</button>
    <a id="downloadLink" style="display: none;">Download File</a>
    <button id="refreshButton">Refresh</button>
    <script>
        const startButton = document.getElementById('startButton');
        const stopButton = document.getElementById('stopButton');
        const downloadLink = document.getElementById('downloadLink');
        const refreshButton = document.getElementById('refreshButton');

        let mediaRecorder;
        let recordedChunks = [];

        startButton.addEventListener('click', async () => {
        document.title = "Recording - JK ScreenRecorder";

        refreshButton.disabled = true;
        mediaRecorder = new MediaRecorder(await navigator.mediaDevices.getDisplayMedia({ video: true, audio: true }));

        mediaRecorder.addEventListener('dataavailable', e => {
            recordedChunks.push(e.data);
        });

        mediaRecorder.addEventListener('stop', () => {
            const recordedBlob = new Blob(recordedChunks, { type: 'video/mp4' });
            downloadRecordedVideo(recordedBlob);

            recordedChunks = [];
            mediaRecorder = null;

            setTimeout(() => {
            refreshButton.disabled = false;
            }, 5000);
            //setTimeout(() => {
            //  location.reload();
            //}, 5000);
        });
        mediaRecorder.start();
        startButton.disabled = true;
        stopButton.disabled = false;
        });

        stopButton.addEventListener('click', () => {
        document.title = "JK ScreenRecorder";
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            mediaRecorder.stop();
            mediaRecorder.stream.getTracks().forEach(track => track.stop());

            startButton.disabled = false;
            stopButton.disabled = true;

            setTimeout(() => {
                refreshButton.disabled = false;
            }, 5000);
        }
        });

        refreshButton.addEventListener('click', () => {
        location.reload();
        });

        function downloadRecordedVideo(recordedBlob) {
        const now = new Date();
        const year = now.getFullYear();
        const month = now.getMonth() + 1;
        const date = now.getDate();
        const hours = now.getHours();
        const minutes = now.getMinutes();
        const seconds = now.getSeconds();

        const timestamp = `${hours}-${minutes}-${seconds}_${date}-${month}-${year}`;
        const fileName = `recorded-video_${timestamp}.mp4`;

        const url = URL.createObjectURL(recordedBlob);
        downloadLink.href = url;
        downloadLink.download = fileName;
        downloadLink.style.display = "block";
        }
    </script>
    <a href="#" id="aboutLink">About</a>
    <div id="aboutModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2>About JK Screen-Recorder</h2>
        <p>This is a screen recording tool created by Josakko that allows you to record your screen and save the recording as a video file.</p>
        <p>To use this tool, simply click the "Start Recording" button to start recording your screen, and then click the "Stop Recording" button when you are finished then download recorded video using "Download File" button.</p>
      </div>
    </div>
    <script>
        var modal = document.getElementById("aboutModal");
        var link = document.getElementById("aboutLink");
        var span = document.getElementsByClassName("close")[0];

        link.onclick = function() {
        modal.style.display = "block";
        }

        span.onclick = function() {
        modal.style.display = "none";
        }

        window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
        }
    </script>
  </body>
</html>

